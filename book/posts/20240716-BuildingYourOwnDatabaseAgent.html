<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>20240716-BuildingYourOwnDatabaseAgent - alanhc-til</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">1</li><li class="chapter-item expanded "><a href="../posts/20231210-convert-post-markdown.html"><strong aria-hidden="true">1.</strong> 20231210-convert-post-markdown</a></li><li class="chapter-item expanded "><a href="../posts/20231213-pyspark.html"><strong aria-hidden="true">2.</strong> 20231213-pyspark</a></li><li class="chapter-item expanded "><a href="../posts/20231217-google-gemini.html"><strong aria-hidden="true">3.</strong> 20231217-google-gemini</a></li><li class="chapter-item expanded "><a href="../posts/20231217-ntu-matches.html"><strong aria-hidden="true">4.</strong> 20231217-ntu-matches</a></li><li class="chapter-item expanded "><a href="../posts/20231222-chat.html"><strong aria-hidden="true">5.</strong> 20231222-chat</a></li><li class="chapter-item expanded "><a href="../posts/20240107-notion-website.html"><strong aria-hidden="true">6.</strong> 20240107-notion-website</a></li><li class="chapter-item expanded "><a href="../posts/20240108-attention.html"><strong aria-hidden="true">7.</strong> 20240108-attention</a></li><li class="chapter-item expanded "><a href="../posts/20240113-data-engineer-salary.html"><strong aria-hidden="true">8.</strong> 20240113-data-engineer-salary</a></li><li class="chapter-item expanded "><a href="../posts/20240119-OSINT.html"><strong aria-hidden="true">9.</strong> 20240119-OSINT</a></li><li class="chapter-item expanded "><a href="../posts/20240122-english-speaking.html"><strong aria-hidden="true">10.</strong> 20240122-english-speaking</a></li><li class="chapter-item expanded "><a href="../posts/20240122-ntu-cool-video-download.html"><strong aria-hidden="true">11.</strong> 20240122-ntu-cool-video-download</a></li><li class="chapter-item expanded "><a href="../posts/20240122-stock-data-design.html"><strong aria-hidden="true">12.</strong> 20240122-stock-data-design</a></li><li class="chapter-item expanded "><a href="../posts/20240123-scalper.html"><strong aria-hidden="true">13.</strong> 20240123-scalper</a></li><li class="chapter-item expanded "><a href="../posts/20240124-break-cloudflare-bot-prevention.html"><strong aria-hidden="true">14.</strong> 20240124-break-cloudflare-bot-prevention</a></li><li class="chapter-item expanded "><a href="../posts/20240125-cache-design.html"><strong aria-hidden="true">15.</strong> 20240125-cache-design</a></li><li class="chapter-item expanded "><a href="../posts/20240125-duplicate-url-design.html"><strong aria-hidden="true">16.</strong> 20240125-duplicate-url-design</a></li><li class="chapter-item expanded "><a href="../posts/20240125-web-crawler-design.html"><strong aria-hidden="true">17.</strong> 20240125-web-crawler-design</a></li><li class="chapter-item expanded "><a href="../posts/20240203-trading-bot.html"><strong aria-hidden="true">18.</strong> 20240203-trading-bot</a></li><li class="chapter-item expanded "><a href="../posts/20240205-salesrank-design.html"><strong aria-hidden="true">19.</strong> 20240205-salesrank-design</a></li><li class="chapter-item expanded "><a href="../posts/20240209-job-insights.html"><strong aria-hidden="true">20.</strong> 20240209-job-insights</a></li><li class="chapter-item expanded "><a href="../posts/20240211-pastebin-design.html"><strong aria-hidden="true">21.</strong> 20240211-pastebin-design</a></li><li class="chapter-item expanded "><a href="../posts/20240211-taiwan-job-insights.html"><strong aria-hidden="true">22.</strong> 20240211-taiwan-job-insights</a></li><li class="chapter-item expanded "><a href="../posts/20240212-linkedin-private-api.html"><strong aria-hidden="true">23.</strong> 20240212-linkedin-private-api</a></li><li class="chapter-item expanded "><a href="../posts/20240215-Deck-of-cards-ood.html"><strong aria-hidden="true">24.</strong> 20240215-Deck-of-cards-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240216-levelsfyi-crawler.html"><strong aria-hidden="true">25.</strong> 20240216-levelsfyi-crawler</a></li><li class="chapter-item expanded "><a href="../posts/20240217-call-center-ood.html"><strong aria-hidden="true">26.</strong> 20240217-call-center-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240217-jigsaw-ood.html"><strong aria-hidden="true">27.</strong> 20240217-jigsaw-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240217-jukebox-ood.html"><strong aria-hidden="true">28.</strong> 20240217-jukebox-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240217-online-book-reader-ood.html"><strong aria-hidden="true">29.</strong> 20240217-online-book-reader-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240217-parking-lot-ood.html"><strong aria-hidden="true">30.</strong> 20240217-parking-lot-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240219-chat-server-ood.html"><strong aria-hidden="true">31.</strong> 20240219-chat-server-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240221-othello-ood.html"><strong aria-hidden="true">32.</strong> 20240221-othello-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240222-text-network-analysis.html"><strong aria-hidden="true">33.</strong> 20240222-text-network-analysis</a></li><li class="chapter-item expanded "><a href="../posts/20240226-Circular-array-ood.html"><strong aria-hidden="true">34.</strong> 20240226-Circular-array-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240226-minesweeper-ood.html"><strong aria-hidden="true">35.</strong> 20240226-minesweeper-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240227-File-Systems-ood.html"><strong aria-hidden="true">36.</strong> 20240227-File-Systems-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240227-Hash-Table-ood.html"><strong aria-hidden="true">37.</strong> 20240227-Hash-Table-ood</a></li><li class="chapter-item expanded "><a href="../posts/20240227-huggingface-nlp.html"><strong aria-hidden="true">38.</strong> 20240227-huggingface-nlp</a></li><li class="chapter-item expanded "><a href="../posts/20240227-warp-terminal.html"><strong aria-hidden="true">39.</strong> 20240227-warp-terminal</a></li><li class="chapter-item expanded "><a href="../posts/20240303-save-password-python.html"><strong aria-hidden="true">40.</strong> 20240303-save-password-python</a></li><li class="chapter-item expanded "><a href="../posts/20240321-interview-warmup.html"><strong aria-hidden="true">41.</strong> 20240321-interview-warmup</a></li><li class="chapter-item expanded "><a href="../posts/20240324-learn-go.html"><strong aria-hidden="true">42.</strong> 20240324-learn-go</a></li><li class="chapter-item expanded "><a href="../posts/20240409-你要如何衡量你的人生.html"><strong aria-hidden="true">43.</strong> 20240409-你要如何衡量你的人生</a></li><li class="chapter-item expanded "><a href="../posts/20240621-公雲學習筆記.html"><strong aria-hidden="true">44.</strong> 20240621-公雲學習筆記</a></li><li class="chapter-item expanded "><a href="../posts/20240716-BuildingYourOwnDatabaseAgent.html" class="active"><strong aria-hidden="true">45.</strong> 20240716-BuildingYourOwnDatabaseAgent</a></li><li class="chapter-item expanded "><a href="../posts/HuggingFaceLLM.html"><strong aria-hidden="true">46.</strong> HuggingFaceLLM</a></li><li class="chapter-item expanded affix "><li class="part-title">ai</li><li class="chapter-item expanded "><a href="../posts/ai/20231028-mozilla-ai.html"><strong aria-hidden="true">47.</strong> 20231028-mozilla-ai</a></li><li class="chapter-item expanded "><a href="../posts/ai/20231209-AI-music-example.html"><strong aria-hidden="true">48.</strong> 20231209-AI-music-example</a></li><li class="chapter-item expanded affix "><li class="part-title">backend</li><li class="chapter-item expanded "><a href="../posts/backend/20231006-fastapi-streaming.html"><strong aria-hidden="true">49.</strong> 20231006-fastapi-streaming</a></li><li class="chapter-item expanded affix "><li class="part-title">blockchain</li><li class="chapter-item expanded "><a href="../posts/blockchain/20221228-solana-nft-tutorial.html"><strong aria-hidden="true">50.</strong> 20221228-solana-nft-tutorial</a></li><li class="chapter-item expanded "><a href="../posts/blockchain/20230824-bigchain.html"><strong aria-hidden="true">51.</strong> 20230824-bigchain</a></li><li class="chapter-item expanded "><a href="../posts/blockchain/20231104-learn-cosmos.html"><strong aria-hidden="true">52.</strong> 20231104-learn-cosmos</a></li><li class="chapter-item expanded affix "><li class="part-title">bot</li><li class="chapter-item expanded "><a href="../posts/bot/20231202-twitter-bot.html"><strong aria-hidden="true">53.</strong> 20231202-twitter-bot</a></li><li class="chapter-item expanded affix "><li class="part-title">c_c++</li><li class="chapter-item expanded "><a href="../posts/c_c++/20171210-vector.html"><strong aria-hidden="true">54.</strong> 20171210-vector</a></li><li class="chapter-item expanded "><a href="../posts/c_c++/20180124-gets-puts.html"><strong aria-hidden="true">55.</strong> 20180124-gets-puts</a></li><li class="chapter-item expanded affix "><li class="part-title">class_notes</li><li class="chapter-item expanded "><a href="../posts/class_notes/*.html"><strong aria-hidden="true">56.</strong> *</a></li><li class="chapter-item expanded affix "><li class="part-title">cloudflare</li><li class="chapter-item expanded "><a href="../posts/cloudflare/20231125-cloudflare-tunnel.html"><strong aria-hidden="true">57.</strong> 20231125-cloudflare-tunnel</a></li><li class="chapter-item expanded affix "><li class="part-title">competative_programing</li><li class="chapter-item expanded "><a href="../posts/competative_programing/20171221-uva10190.html"><strong aria-hidden="true">58.</strong> 20171221-uva10190</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180128-uva10931.html"><strong aria-hidden="true">59.</strong> 20180128-uva10931</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180131-uva11917.html"><strong aria-hidden="true">60.</strong> 20180131-uva11917</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180205-uva10405.html"><strong aria-hidden="true">61.</strong> 20180205-uva10405</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180206-uva10162.html"><strong aria-hidden="true">62.</strong> 20180206-uva10162</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180209-uva406.html"><strong aria-hidden="true">63.</strong> 20180209-uva406</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180210-NCTU-PCCA-winter-notes.html"><strong aria-hidden="true">64.</strong> 20180210-NCTU-PCCA-winter-notes</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180212-uva10611.html"><strong aria-hidden="true">65.</strong> 20180212-uva10611</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180222-uva401.html"><strong aria-hidden="true">66.</strong> 20180222-uva401</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180309-uva141.html"><strong aria-hidden="true">67.</strong> 20180309-uva141</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180312-uva10190.html"><strong aria-hidden="true">68.</strong> 20180312-uva10190</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180314-uva105.html"><strong aria-hidden="true">69.</strong> 20180314-uva105</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180317-uva10409.html"><strong aria-hidden="true">70.</strong> 20180317-uva10409</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20180405-uva630.html"><strong aria-hidden="true">71.</strong> 20180405-uva630</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/20190409-uva409.html"><strong aria-hidden="true">72.</strong> 20190409-uva409</a></li><li class="chapter-item expanded "><a href="../posts/competative_programing/閱讀筆記-競技程式路線圖.html"><strong aria-hidden="true">73.</strong> 閱讀筆記-競技程式路線圖</a></li><li class="chapter-item expanded affix "><li class="part-title">computer_graphics</li><li class="chapter-item expanded "><a href="../posts/computer_graphics/20190614-CGfinal.html"><strong aria-hidden="true">74.</strong> 20190614-CGfinal</a></li><li class="chapter-item expanded affix "><li class="part-title">crawler</li><li class="chapter-item expanded "><a href="../posts/crawler/20230813-back-up-crawler.html"><strong aria-hidden="true">75.</strong> 20230813-back-up-crawler</a></li><li class="chapter-item expanded "><a href="../posts/crawler/20240121-Web-Scraping-Instagram-with-Selenium.html"><strong aria-hidden="true">76.</strong> 20240121-Web-Scraping-Instagram-with-Selenium</a></li><li class="chapter-item expanded affix "><li class="part-title">db</li><li class="chapter-item expanded "><a href="../posts/db/20230831-mongodb-aggregate-multiple-group.html"><strong aria-hidden="true">77.</strong> 20230831-mongodb-aggregate-multiple-group</a></li><li class="chapter-item expanded affix "><li class="part-title">devops</li><li class="chapter-item expanded "><a href="../posts/devops/20231124-terraform-vercel.html"><strong aria-hidden="true">78.</strong> 20231124-terraform-vercel</a></li><li class="chapter-item expanded affix "><li class="part-title">docker</li><li class="chapter-item expanded "><a href="../posts/docker/20231209-docker-machine-learning.html"><strong aria-hidden="true">79.</strong> 20231209-docker-machine-learning</a></li><li class="chapter-item expanded affix "><li class="part-title">dsa</li><li class="chapter-item expanded "><a href="../posts/dsa/20171217-DP.html"><strong aria-hidden="true">80.</strong> 20171217-DP</a></li><li class="chapter-item expanded "><a href="../posts/dsa/20171219-recursion.html"><strong aria-hidden="true">81.</strong> 20171219-recursion</a></li><li class="chapter-item expanded "><a href="../posts/dsa/20171230-recursion.html"><strong aria-hidden="true">82.</strong> 20171230-recursion</a></li><li class="chapter-item expanded "><a href="../posts/dsa/20180209-linked-list.html"><strong aria-hidden="true">83.</strong> 20180209-linked-list</a></li><li class="chapter-item expanded "><a href="../posts/dsa/20180228-hash-table.html"><strong aria-hidden="true">84.</strong> 20180228-hash-table</a></li><li class="chapter-item expanded "><a href="../posts/dsa/20231103-linklist.html"><strong aria-hidden="true">85.</strong> 20231103-linklist</a></li><li class="chapter-item expanded "><a href="../posts/fastapi-k8s.html"><strong aria-hidden="true">86.</strong> fastapi-k8s</a></li><li class="chapter-item expanded "><a href="../posts/first-day.html"><strong aria-hidden="true">87.</strong> first-day</a></li><li class="chapter-item expanded affix "><li class="part-title">frontend</li><li class="chapter-item expanded "><a href="../posts/frontend/20230812-react-syntax-clipboard.html"><strong aria-hidden="true">88.</strong> 20230812-react-syntax-clipboard</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230816-nprogress.html"><strong aria-hidden="true">89.</strong> 20230816-nprogress</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230817-next-sitemap.html"><strong aria-hidden="true">90.</strong> 20230817-next-sitemap</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230818-markdown-section-link.html"><strong aria-hidden="true">91.</strong> 20230818-markdown-section-link</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230819-mermaid-js.html"><strong aria-hidden="true">92.</strong> 20230819-mermaid-js</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230820-nexjs13.html"><strong aria-hidden="true">93.</strong> 20230820-nexjs13</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230824-chakra-darkmode.html"><strong aria-hidden="true">94.</strong> 20230824-chakra-darkmode</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230825-rss.html"><strong aria-hidden="true">95.</strong> 20230825-rss</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230826-import-alias.html"><strong aria-hidden="true">96.</strong> 20230826-import-alias</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230826-next-seo.html"><strong aria-hidden="true">97.</strong> 20230826-next-seo</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230827-chat-app.html"><strong aria-hidden="true">98.</strong> 20230827-chat-app</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230827-next-pwa.html"><strong aria-hidden="true">99.</strong> 20230827-next-pwa</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230829-chakra-ui.html"><strong aria-hidden="true">100.</strong> 20230829-chakra-ui</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230830-nextjs-google-analytics.html"><strong aria-hidden="true">101.</strong> 20230830-nextjs-google-analytics</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230831-kbar.html"><strong aria-hidden="true">102.</strong> 20230831-kbar</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230831-mdx.html"><strong aria-hidden="true">103.</strong> 20230831-mdx</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230907-react-native.html"><strong aria-hidden="true">104.</strong> 20230907-react-native</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230924-QR-Code.html"><strong aria-hidden="true">105.</strong> 20230924-QR-Code</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230924-wagami.html"><strong aria-hidden="true">106.</strong> 20230924-wagami</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20230929-rn-qrcode.html"><strong aria-hidden="true">107.</strong> 20230929-rn-qrcode</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20231010-webauthn.html"><strong aria-hidden="true">108.</strong> 20231010-webauthn</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20231107-MUI-toolpad.html"><strong aria-hidden="true">109.</strong> 20231107-MUI-toolpad</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20231107-imgbb.html"><strong aria-hidden="true">110.</strong> 20231107-imgbb</a></li><li class="chapter-item expanded "><a href="../posts/frontend/20231112-nextjs-upload-large-file.html"><strong aria-hidden="true">111.</strong> 20231112-nextjs-upload-large-file</a></li><li class="chapter-item expanded affix "><li class="part-title">genai</li><li class="chapter-item expanded "><a href="../posts/genai/20231108-How-Diffusion-Models-Work.html"><strong aria-hidden="true">112.</strong> 20231108-How-Diffusion-Models-Work</a></li><li class="chapter-item expanded "><a href="../posts/genai/20231110-生成式AI淺談圖像生成模型-Diffusion-Model-原理.html"><strong aria-hidden="true">113.</strong> 20231110-生成式AI淺談圖像生成模型-Diffusion-Model-原理</a></li><li class="chapter-item expanded affix "><li class="part-title">jobs</li><li class="chapter-item expanded "><a href="../posts/jobs/20220811-LINE-Blockchain-Developer-Intern.html"><strong aria-hidden="true">114.</strong> 20220811-LINE-Blockchain-Developer-Intern</a></li><li class="chapter-item expanded affix "><li class="part-title">kubenetes</li><li class="chapter-item expanded "><a href="../posts/kubenetes/20221231-k8s-notes.html"><strong aria-hidden="true">115.</strong> 20221231-k8s-notes</a></li><li class="chapter-item expanded affix "><li class="part-title">learning</li><li class="chapter-item expanded "><a href="../posts/learning/20231023-learning-from-lin.html"><strong aria-hidden="true">116.</strong> 20231023-learning-from-lin</a></li><li class="chapter-item expanded affix "><li class="part-title">llm</li><li class="chapter-item expanded "><a href="../posts/llm/20231023-Pair-Programming-with-a-Large-Language-Model.html"><strong aria-hidden="true">117.</strong> 20231023-Pair-Programming-with-a-Large-Language-Model</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231026-ChatGPT-Prompt-Engineering-for-Developers.html"><strong aria-hidden="true">118.</strong> 20231026-ChatGPT-Prompt-Engineering-for-Developers</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231029-Building-Systems-with-the-ChatGPT-API.html"><strong aria-hidden="true">119.</strong> 20231029-Building-Systems-with-the-ChatGPT-API</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231031-Andrew-Ng-Opportunities-in-AI-2023.html"><strong aria-hidden="true">120.</strong> 20231031-Andrew-Ng-Opportunities-in-AI-2023</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231101-generative-ai-for-everyone.html"><strong aria-hidden="true">121.</strong> 20231101-generative-ai-for-everyone</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231103-Finetuning-Large-Language-Models.html"><strong aria-hidden="true">122.</strong> 20231103-Finetuning-Large-Language-Models</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231110-80分鐘快速了解大型語言模型-5-30有咒術迴戰雷.html"><strong aria-hidden="true">123.</strong> 20231110-80分鐘快速了解大型語言模型-5-30有咒術迴戰雷</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231129-ShouldYouUseOpenSourceLargeLanguageModels?.html"><strong aria-hidden="true">124.</strong> 20231129-ShouldYouUseOpenSourceLargeLanguageModels?</a></li><li class="chapter-item expanded "><a href="../posts/llm/20231130-Building-and-Evaluating-Advanced-RAG.html"><strong aria-hidden="true">125.</strong> 20231130-Building-and-Evaluating-Advanced-RAG</a></li><li class="chapter-item expanded "><a href="../posts/llm-k8s.html"><strong aria-hidden="true">126.</strong> llm-k8s</a></li><li class="chapter-item expanded affix "><li class="part-title">maker</li><li class="chapter-item expanded "><a href="../posts/maker/20171105-makerfair.html"><strong aria-hidden="true">127.</strong> 20171105-makerfair</a></li><li class="chapter-item expanded affix "><li class="part-title">monorepo</li><li class="chapter-item expanded "><a href="../posts/monorepo/20220721-upgrade-nx-repo-to-react-18.html"><strong aria-hidden="true">128.</strong> 20220721-upgrade-nx-repo-to-react-18</a></li><li class="chapter-item expanded "><a href="../posts/monorepo/20220811-monorepo-development.html"><strong aria-hidden="true">129.</strong> 20220811-monorepo-development</a></li><li class="chapter-item expanded "><a href="../posts/monorepo/20230920-nx.html"><strong aria-hidden="true">130.</strong> 20230920-nx</a></li><li class="chapter-item expanded "><a href="../posts/nextjs-markdown.html"><strong aria-hidden="true">131.</strong> nextjs-markdown</a></li><li class="chapter-item expanded "><a href="../posts/nextjs.html"><strong aria-hidden="true">132.</strong> nextjs</a></li><li class="chapter-item expanded affix "><li class="part-title">nft</li><li class="chapter-item expanded "><a href="../posts/nft/20221230-tezos-nft-tutorial.html"><strong aria-hidden="true">133.</strong> 20221230-tezos-nft-tutorial</a></li><li class="chapter-item expanded "><a href="../posts/nft/20230108-solidity-nft.html"><strong aria-hidden="true">134.</strong> 20230108-solidity-nft</a></li><li class="chapter-item expanded "><a href="../posts/nft/20230109-ipfs-upload.html"><strong aria-hidden="true">135.</strong> 20230109-ipfs-upload</a></li><li class="chapter-item expanded affix "><li class="part-title">programing</li><li class="chapter-item expanded "><a href="../posts/programing/20171027-bnf.html"><strong aria-hidden="true">136.</strong> 20171027-bnf</a></li><li class="chapter-item expanded "><a href="../posts/programing/20171106-gcd.html"><strong aria-hidden="true">137.</strong> 20171106-gcd</a></li><li class="chapter-item expanded "><a href="../posts/programing/20180123-int2str.html"><strong aria-hidden="true">138.</strong> 20180123-int2str</a></li><li class="chapter-item expanded affix "><li class="part-title">projects</li><li class="chapter-item expanded "><a href="../posts/projects/20210820-開發mcu-up-銘傳金手指3-0-的那些事兒.html"><strong aria-hidden="true">139.</strong> 20210820-開發mcu-up-銘傳金手指3-0-的那些事兒</a></li><li class="chapter-item expanded "><a href="../posts/projects/20220531-Decentral-Showroom-NTU-DApp-Term-project.html"><strong aria-hidden="true">140.</strong> 20220531-Decentral-Showroom-NTU-DApp-Term-project</a></li><li class="chapter-item expanded "><a href="../posts/python使用pyinstaller製作桌面應用程式.html"><strong aria-hidden="true">141.</strong> python使用pyinstaller製作桌面應用程式</a></li><li class="chapter-item expanded "><a href="../posts/quotes.html"><strong aria-hidden="true">142.</strong> quotes</a></li><li class="chapter-item expanded affix "><li class="part-title">security</li><li class="chapter-item expanded "><a href="../posts/security/20171102-computer-virus.html"><strong aria-hidden="true">143.</strong> 20171102-computer-virus</a></li><li class="chapter-item expanded affix "><li class="part-title">shell</li><li class="chapter-item expanded "><a href="../posts/shell/20230924-cmd-copy.html"><strong aria-hidden="true">144.</strong> 20230924-cmd-copy</a></li><li class="chapter-item expanded affix "><li class="part-title">software_engineering</li><li class="chapter-item expanded "><a href="../posts/software_engineering/20171027-refactor.html"><strong aria-hidden="true">145.</strong> 20171027-refactor</a></li><li class="chapter-item expanded "><a href="../posts/software_engineering/20171202-styleguide.html"><strong aria-hidden="true">146.</strong> 20171202-styleguide</a></li><li class="chapter-item expanded affix "><li class="part-title">startup</li><li class="chapter-item expanded "><a href="../posts/startup/20230926-21-things-before-21.html"><strong aria-hidden="true">147.</strong> 20230926-21-things-before-21</a></li><li class="chapter-item expanded "><a href="../posts/startup/20231115-How-to-Build-An-MVP-Startup-School.html"><strong aria-hidden="true">148.</strong> 20231115-How-to-Build-An-MVP-Startup-School</a></li><li class="chapter-item expanded affix "><li class="part-title">tools</li><li class="chapter-item expanded "><a href="../posts/tools/20180119-hackmd.html"><strong aria-hidden="true">149.</strong> 20180119-hackmd</a></li><li class="chapter-item expanded "><a href="../posts/tools/20230826-imgur.html"><strong aria-hidden="true">150.</strong> 20230826-imgur</a></li><li class="chapter-item expanded "><a href="../posts/tools/20230827-notion-alternative.html"><strong aria-hidden="true">151.</strong> 20230827-notion-alternative</a></li><li class="chapter-item expanded affix "><li class="part-title">vector_database</li><li class="chapter-item expanded "><a href="../posts/vector_database/20231115-Building-Multi-Modal-Search-with-Vector-Databases.html"><strong aria-hidden="true">152.</strong> 20231115-Building-Multi-Modal-Search-with-Vector-Databases</a></li><li class="chapter-item expanded "><a href="../posts/vector_database/20231116-Vector-Databases-from-Embeddings-to-Applications.html"><strong aria-hidden="true">153.</strong> 20231116-Vector-Databases-from-Embeddings-to-Applications</a></li><li class="chapter-item expanded affix "><li class="part-title">vscode</li><li class="chapter-item expanded "><a href="../posts/vscode/20230827-vscode-animate-extension.html"><strong aria-hidden="true">154.</strong> 20230827-vscode-animate-extension</a></li><li class="chapter-item expanded affix "><li class="part-title">web3</li><li class="chapter-item expanded "><a href="../posts/web3/20211011-虛擬人課堂筆記-spark-ar.html"><strong aria-hidden="true">155.</strong> 20211011-虛擬人課堂筆記-spark-ar</a></li><li class="chapter-item expanded "><a href="../posts/web3/20211018-虛擬人課堂筆記2.html"><strong aria-hidden="true">156.</strong> 20211018-虛擬人課堂筆記2</a></li><li class="chapter-item expanded "><a href="../posts/web3/20211027-虛擬人課堂筆記3-unity-facecapture.html"><strong aria-hidden="true">157.</strong> 20211027-虛擬人課堂筆記3-unity-facecapture</a></li><li class="chapter-item expanded "><a href="../posts/web3/20211028-虛擬人課堂筆記4-vroid.html"><strong aria-hidden="true">158.</strong> 20211028-虛擬人課堂筆記4-vroid</a></li><li class="chapter-item expanded "><a href="../posts/web3/20220518-web3-世界裡的驗證機制-以Tezos為例.html"><strong aria-hidden="true">159.</strong> 20220518-web3-世界裡的驗證機制-以Tezos為例</a></li><li class="chapter-item expanded "><a href="../posts/web3/20230827-orbitdb.html"><strong aria-hidden="true">160.</strong> 20230827-orbitdb</a></li><li class="chapter-item expanded "><a href="../posts/web3/20230828-ipfs.html"><strong aria-hidden="true">161.</strong> 20230828-ipfs</a></li><li class="chapter-item expanded "><a href="../posts/web3/20230828-libp2p.html"><strong aria-hidden="true">162.</strong> 20230828-libp2p</a></li><li class="chapter-item expanded "><a href="../posts/web3/20230829-orbit-chat.html"><strong aria-hidden="true">163.</strong> 20230829-orbit-chat</a></li><li class="chapter-item expanded "><a href="../posts/web3/20230919-hardhat.html"><strong aria-hidden="true">164.</strong> 20230919-hardhat</a></li><li class="chapter-item expanded affix "><li class="part-title">webrtc</li><li class="chapter-item expanded "><a href="../posts/webrtc/20230829-peerjs.html"><strong aria-hidden="true">165.</strong> 20230829-peerjs</a></li><li class="chapter-item expanded "><a href="../posts/windows下的套件管理-Chocolatey.html"><strong aria-hidden="true">166.</strong> windows下的套件管理-Chocolatey</a></li><li class="chapter-item expanded "><a href="../posts/超簡單!一文理解如何使用私有大型語言模型LLM-Ollama＋OpenWebUI篇.html"><strong aria-hidden="true">167.</strong> 超簡單!一文理解如何使用私有大型語言模型LLM-Ollama＋OpenWebUI篇</a></li><li class="chapter-item expanded "><a href="../posts/閱讀筆記-建中2021校內培訓簡報.html"><strong aria-hidden="true">168.</strong> 閱讀筆記-建中2021校內培訓簡報</a></li><li class="chapter-item expanded "><a href="../posts/閱讀筆記-建中2021暑假資讀投影片-謝一.html"><strong aria-hidden="true">169.</strong> 閱讀筆記-建中2021暑假資讀投影片-謝一</a></li><li class="chapter-item expanded "><a href="../posts/國外工作.html"><strong aria-hidden="true">170.</strong> 國外工作</a></li><li class="chapter-item expanded "><a href="../posts/更快的影片學習方法.html"><strong aria-hidden="true">171.</strong> 更快的影片學習方法</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">alanhc-til</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>title: Building Your Own Database Agent
date: 2024-07-16
tags:</p>
<ul>
<li>llm
updated: 2024-07-16
up:</li>
</ul>
<hr />
<p><strong>Building Your Own Database Agent</strong></p>
<p><a href="https://learn.deeplearning.ai/courses/building-your-own-database-agent/lesson/1/introduction"><strong>https://learn.deeplearning.ai/courses/building-your-own-database-agent/lesson/1/introduction</strong></a>
![[Database Agent 1.png]]
![[Artificial Intelligence.png]]
![[Fine tuning.png]]
![[Database Agents.png]]</p>
<p>from langchain.agents.agent_types import AgentType</p>
<p>from langchain_experimental.agents.agent_toolkits import create_pandas_dataframe_agent</p>
<p>agent = create_pandas_dataframe_agent(llm=model,df=df,verbose=True)</p>
<p>agent.invoke("how many rows are there?")</p>
<p><strong>&gt; Entering new AgentExecutor chain...</strong></p>
<p><strong>Thought: To find out the number of rows in a pandas DataFrame, I can use the <code>shape</code> attribute which returns a tuple with the number of rows and columns. The first element of the tuple will give me the number of rows.</strong></p>
<p><strong>Action: python_repl_ast</strong></p>
<p><strong>Action Input: df.shape[0]</strong></p>
<p>Observation: <strong>20780</strong></p>
<p>Thought:<strong>I now know the final answer.</strong></p>
<p><strong>Final Answer: There are 20780 rows in the dataframe <code>df</code>.</strong></p>
<p><strong>&gt; Finished chain.</strong></p>
<p>{'input': 'how many rows are there?',</p>
<p> 'output': 'There are 20780 rows in the dataframe <code>df</code>.'}</p>
<p>CSV_PROMPT_PREFIX = """</p>
<p>First set the pandas display options to show all the columns,</p>
<p>get the column names, then answer the question.</p>
<p>"""</p>
<p>CSV_PROMPT_SUFFIX = """</p>
<ul>
<li><strong>ALWAYS</strong> before giving the Final Answer, try another method.</li>
</ul>
<p>Then reflect on the answers of the two methods you did and ask yourself</p>
<p>if it answers correctly the original question.</p>
<p>If you are not sure, try another method.</p>
<ul>
<li>If the methods tried do not give the same result,reflect and</li>
</ul>
<p>try again until you have two methods that have the same result.</p>
<ul>
<li>If you still cannot arrive to a consistent result, say that</li>
</ul>
<p>you are not sure of the answer.</p>
<ul>
<li>If you are sure of the correct answer, create a beautiful</li>
</ul>
<p>and thorough response using Markdown.</p>
<ul>
<li>**DO NOT MAKE UP AN ANSWER OR USE PRIOR KNOWLEDGE,</li>
</ul>
<p>ONLY USE THE RESULTS OF THE CALCULATIONS YOU HAVE DONE**.</p>
<ul>
<li><strong>ALWAYS</strong>, as part of your "Final Answer", explain how you got</li>
</ul>
<p>to the answer on a section that starts with: "\n\nExplanation:\n".</p>
<p>In the explanation, mention the column names that you used to get</p>
<p>to the final answer.</p>
<p>"""</p>
<p>QUESTION = "How may patients were hospitalized during July 2020" </p>
<p>"in Texas, and nationwide as the total of all states?"</p>
<p>"Use the hospitalizedIncrease column" </p>
<p>agent.invoke(CSV_PROMPT_PREFIX + QUESTION + CSV_PROMPT_SUFFIX)
![[Database.png]]
![[Pasted Graphic 7.png]]</p>
<h1 id="path-to-your-sqlite-database-file"><a class="header" href="#path-to-your-sqlite-database-file">Path to your SQLite database file</a></h1>
<p>database_file_path = "./db/test.db"</p>
<h1 id="create-an-engine-to-connect-to-the-sqlite-database"><a class="header" href="#create-an-engine-to-connect-to-the-sqlite-database">Create an engine to connect to the SQLite database</a></h1>
<h1 id="sqlite-only-requires-the-path-to-the-database-file"><a class="header" href="#sqlite-only-requires-the-path-to-the-database-file">SQLite only requires the path to the database file</a></h1>
<p>engine = create_engine(f'sqlite:///{database_file_path}')</p>
<p>file_url = "./data/all-states-history.csv"</p>
<p>df = pd.read_csv(file_url).fillna(value = 0)</p>
<p>df.to_sql(</p>
<p>    'all_states_history',</p>
<p>    con=engine,</p>
<p>    if_exists='replace',</p>
<p>    index=False</p>
<p>)</p>
<p>MSSQL_AGENT_PREFIX = """</p>
<p>You are an agent designed to interact with a SQL database.</p>
<h2 id="instructions"><a class="header" href="#instructions">Instructions:</a></h2>
<ul>
<li>Given an input question, create a syntactically correct {dialect} query</li>
</ul>
<p>to run, then look at the results of the query and return the answer.</p>
<ul>
<li>Unless the user specifies a specific number of examples they wish to</li>
</ul>
<p>obtain, <strong>ALWAYS</strong> limit your query to at most {top_k} results.</p>
<ul>
<li>You can order the results by a relevant column to return the most</li>
</ul>
<p>interesting examples in the database.</p>
<ul>
<li>Never query for all the columns from a specific table, only ask for</li>
</ul>
<p>the relevant columns given the question.</p>
<ul>
<li>
<p>You have access to tools for interacting with the database.</p>
</li>
<li>
<p>You MUST double check your query before executing it.If you get an error</p>
</li>
</ul>
<p>while executing a query,rewrite the query and try again.</p>
<ul>
<li>DO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.)</li>
</ul>
<p>to the database.</p>
<ul>
<li>DO NOT MAKE UP AN ANSWER OR USE PRIOR KNOWLEDGE, ONLY USE THE RESULTS</li>
</ul>
<p>OF THE CALCULATIONS YOU HAVE DONE.</p>
<ul>
<li>Your response should be in Markdown. However, **when running  a SQL Query</li>
</ul>
<p>in "Action Input", do not include the markdown backticks**.</p>
<p>Those are only for formatting the response, not for executing the command.</p>
<ul>
<li>ALWAYS, as part of your final answer, explain how you got to the answer</li>
</ul>
<p>on a section that starts with: "Explanation:". Include the SQL query as</p>
<p>part of the explanation section.</p>
<ul>
<li>If the question does not seem related to the database, just return</li>
</ul>
<p>"I don't know" as the answer.</p>
<ul>
<li>Only use the below tools. Only use the information returned by the</li>
</ul>
<p>below tools to construct your query and final answer.</p>
<ul>
<li>Do not make up table names, only use the tables returned by any of the</li>
</ul>
<p>tools below.</p>
<h2 id="tools"><a class="header" href="#tools">Tools:</a></h2>
<p>"""</p>
<p>MSSQL_AGENT_FORMAT_INSTRUCTIONS = """</p>
<h2 id="use-the-following-format"><a class="header" href="#use-the-following-format">Use the following format:</a></h2>
<p>Question: the input question you must answer.</p>
<p>Thought: you should always think about what to do.</p>
<p>Action: the action to take, should be one of [{tool_names}].</p>
<p>Action Input: the input to the action.</p>
<p>Observation: the result of the action.</p>
<p>... (this Thought/Action/Action Input/Observation can repeat N times)</p>
<p>Thought: I now know the final answer.</p>
<p>Final Answer: the final answer to the original input question.</p>
<p>Example of Final Answer:</p>
<p>&lt;=== Beginning of example</p>
<p>Action: query_sql_db</p>
<p>Action Input: </p>
<p>SELECT TOP (10) [death]</p>
<p>FROM covidtracking </p>
<p>WHERE state = 'TX' AND date LIKE '2020%'</p>
<p>Observation:</p>
<p>[(27437.0,), (27088.0,), (26762.0,), (26521.0,), (26472.0,), (26421.0,), (26408.0,)]</p>
<p>Thought:I now know the final answer</p>
<p>Final Answer: There were 27437 people who died of covid in Texas in 2020.</p>
<p>Explanation:</p>
<p>I queried the <code>covidtracking</code> table for the <code>death</code> column where the state</p>
<p>is 'TX' and the date starts with '2020'. The query returned a list of tuples</p>
<p>with the number of deaths for each day in 2020. To answer the question,</p>
<p>I took the sum of all the deaths in the list, which is 27437.</p>
<p>I used the following query</p>
<pre><code class="language-sql">
SELECT [death] FROM covidtracking WHERE state = 'TX' AND date LIKE '2020%'"

</code></pre>
<p>===&gt; End of Example</p>
<p>"""</p>
<p>llm = AzureChatOpenAI(</p>
<p>    openai_api_version="2023-05-15",</p>
<p>    azure_deployment="gpt-4-1106",</p>
<p>    azure_endpoint=os.getenv("AZURE_OPENAI_ENDPOINT"),</p>
<p>    temperature=0, </p>
<p>    max_tokens=500</p>
<p>)</p>
<p>db = SQLDatabase.from_uri(f'sqlite:///{database_file_path}')</p>
<p>toolkit = SQLDatabaseToolkit(db=db, llm=llm)</p>
<p>QUESTION = """How may patients were hospitalized during October 2020</p>
<p>in New York, and nationwide as the total of all states?</p>
<p>Use the hospitalizedIncrease column</p>
<p>"""</p>
<p>agent_executor_SQL = create_sql_agent(</p>
<p>    prefix=MSSQL_AGENT_PREFIX,</p>
<p>    format_instructions = MSSQL_AGENT_FORMAT_INSTRUCTIONS,</p>
<p>    llm=llm,</p>
<p>    toolkit=toolkit,</p>
<p>    top_k=30,</p>
<p>    verbose=True</p>
<p>)
![[Function Calling.png]]</p>
<p>def get_current_weather(location, unit="fahrenheit"):</p>
<p>    """Get the current weather in a given location. </p>
<p>    The default unit when not specified is fahrenheit"""</p>
<p>    if "new york" in location.lower():</p>
<p>        return json.dumps(</p>
<p>            {"location": "New York", "temperature": "40", "unit": unit}</p>
<p>        )</p>
<p>    elif "san francisco" in location.lower():</p>
<p>        return json.dumps(</p>
<p>            {"location": "San Francisco", "temperature": "50", "unit": unit}</p>
<p>        )</p>
<p>    elif "las vegas" in location.lower():</p>
<p>        return json.dumps(</p>
<p>            {"location": "Las Vegas", "temperature": "70", "unit": unit}</p>
<p>        )</p>
<p>    else:</p>
<p>        return json.dumps(</p>
<p>            {"location": location, "temperature": "unknown"}</p>
<p>        )</p>
<p>get_current_weather("New York")</p>
<p>messages = [</p>
<p>    {"role": "user",</p>
<p>     "content": """What's the weather like in San Francisco,</p>
<p>                   New York, and Las Vegass?"""</p>
<p>    }</p>
<p>]</p>
<p>tools = [</p>
<p>    {</p>
<p>        "type": "function",</p>
<p>        "function": {</p>
<p>            "name": "get_current_weather",</p>
<p>            "description": """Get the current weather in a given</p>
<p>                              location.The default unit when not</p>
<p>                              specified is fahrenheit""",</p>
<p>            "parameters": {</p>
<p>                "type": "object",</p>
<p>                "properties": {</p>
<p>                    "location": {</p>
<p>                        "type": "string",</p>
<p>                        "description": """The city and state,</p>
<p>                                        e.g. San Francisco, CA""",</p>
<p>                    },</p>
<p>                    "unit": {</p>
<p>                        "type": "string",</p>
<p>                        "default":"fahrenheit",</p>
<p>                        "enum": [ "fahrenheit", "celsius"],</p>
<p>                        "description": """The messuring unit for</p>
<p>                                          the temperature.</p>
<p>                                          If not explicitly specified</p>
<p>                                          the default unit is </p>
<p>                                          fahrenheit"""</p>
<p>                    },</p>
<p>                },</p>
<p>                "required": ["location"],</p>
<p>            },</p>
<p>        },</p>
<p>    }</p>
<p>]</p>
<p>response = client.chat.completions.create(</p>
<p>    model="gpt-4-1106",</p>
<p>    messages=messages,</p>
<p>    tools=tools,</p>
<p>    tool_choice="auto", </p>
<p>)</p>
<p>response_message = response.choices[0].message</p>
<p>tool_calls = response_message.tool_calls</p>
<p>if tool_calls:</p>
<p>    print (tool_calls)</p>
<p>    available_functions = {</p>
<p>        "get_current_weather": get_current_weather,</p>
<p>    } </p>
<p>    messages.append(response_message)  </p>
<p>    for tool_call in tool_calls:</p>
<p>        function_name = tool_call.function.name</p>
<p>        function_to_call = available_functions[function_name]</p>
<p>        function_args = json.loads(tool_call.function.arguments)</p>
<p>        function_response = function_to_call(</p>
<p>            location=function_args.get("location"),</p>
<p>            unit=function_args.get("unit"),</p>
<p>        )</p>
<p>        messages.append(</p>
<p>            {</p>
<p>                "tool_call_id": tool_call.id,</p>
<p>                "role": "tool",</p>
<p>                "name": function_name,</p>
<p>                "content": function_response,</p>
<p>            }</p>
<p>        )  </p>
<p>    print (messages)</p>
<p>second_response = client.chat.completions.create(</p>
<p>            model="gpt-4-1106",</p>
<p>            messages=messages,</p>
<p>        )</p>
<p>print (second_response)
![[Building Your Own Database.png]]
![[for scenarios like e-commerce..png]]
![[Code Interpreter.png]]</p>
<p>from sqlalchemy import create_engine</p>
<p>import pandas as pd</p>
<p>df = pd.read_csv("./data/all-states-history.csv").fillna(value = 0)</p>
<p>response = client.chat.completions.create(</p>
<p>    model="gpt-4-1106",</p>
<p>    messages=messages,</p>
<p>    tools=tools_sql,</p>
<p>    tool_choice="auto",</p>
<p>)</p>
<p>response_message = response.choices[0].message</p>
<p>tool_calls = response_message.tool_calls</p>
<p>if tool_calls:</p>
<p>    print (tool_calls)</p>
<p>    available_functions = {</p>
<p>        "get_positive_cases_for_state_on_date": get_positive_cases_for_state_on_date,</p>
<p>        "get_hospitalized_increase_for_state_on_date":get_hospitalized_increase_for_state_on_date</p>
<p>    }  </p>
<p>    messages.append(response_message)  </p>
<p>    for tool_call in tool_calls:</p>
<p>        function_name = tool_call.function.name</p>
<p>        function_to_call = available_functions[function_name]</p>
<p>        function_args = json.loads(tool_call.function.arguments)</p>
<p>        function_response = function_to_call(</p>
<p>            state_abbr=function_args.get("state_abbr"),</p>
<p>            specific_date=function_args.get("specific_date"),</p>
<p>        )</p>
<p>        messages.append(</p>
<p>            {</p>
<p>                "tool_call_id": tool_call.id,</p>
<p>                "role": "tool",</p>
<p>                "name": function_name,</p>
<p>                "content": str(function_response),</p>
<p>            }</p>
<p>        ) </p>
<p>    print(messages)</p>
<p>second_response = client.chat.completions.create(</p>
<p>            model="gpt-4-1106",</p>
<p>            messages=messages,</p>
<p>        )</p>
<p>print (second_response)</p>
<p>client = AzureOpenAI(</p>
<p>    api_key=os.getenv("AZURE_OPENAI_KEY"),</p>
<p>    api_version="2024-02-15-preview",</p>
<p>    azure_endpoint = os.getenv("AZURE_OPENAI_ENDPOINT")</p>
<p>    )</p>
<h1 id="i-create-assistant"><a class="header" href="#i-create-assistant">I) Create assistant</a></h1>
<p>assistant = client.beta.assistants.create(</p>
<p>  instructions="""You are an assistant answering questions </p>
<p>                  about a Covid dataset.""",</p>
<p>  model="gpt-4-1106", </p>
<p>  tools=Helper.tools_sql)</p>
<h1 id="ii-create-thread"><a class="header" href="#ii-create-thread">II) Create thread</a></h1>
<p>thread = client.beta.threads.create()</p>
<p>print(thread)</p>
<h1 id="iii-add-message"><a class="header" href="#iii-add-message">III) Add message</a></h1>
<p>message = client.beta.threads.messages.create(</p>
<p>    thread_id=thread.id,</p>
<p>    role="user",</p>
<p>    content="""how many hospitalized people we had in Alaska</p>
<p>               the 2021-03-05?"""</p>
<p>)</p>
<p>print(message)</p>
<p>messages = client.beta.threads.messages.list(</p>
<p>  thread_id=thread.id</p>
<p>)</p>
<p>print(messages.model_dump_json(indent=2))</p>
<h1 id="iv-run-assistant-on-thread"><a class="header" href="#iv-run-assistant-on-thread">IV) Run assistant on thread</a></h1>
<p>run = client.beta.threads.runs.create(</p>
<p>  thread_id=thread.id,</p>
<p>  assistant_id=assistant.id,</p>
<p>)</p>
<p>import time</p>
<p>from IPython.display import clear_output</p>
<p>start_time = time.time()</p>
<p>status = run.status</p>
<p>while status not in ["completed", "cancelled", "expired", "failed"]:</p>
<p>    time.sleep(5)</p>
<p>    run = client.beta.threads.runs.retrieve(</p>
<p>        thread_id=thread.id,run_id=run.id</p>
<p>    )</p>
<p>    print("Elapsed time: {} minutes {} seconds".format(</p>
<p>        int((time.time() - start_time) // 60),</p>
<p>        int((time.time() - start_time) % 60))</p>
<p>         )</p>
<p>    status = run.status</p>
<p>    print(f'Status: {status}')</p>
<p>    if (status=="requires_action"):</p>
<p>        available_functions = {</p>
<p>            "get_positive_cases_for_state_on_date": get_positive_cases_for_state_on_date,</p>
<p>            "get_hospitalized_increase_for_state_on_date":get_hospitalized_increase_for_state_on_date</p>
<p>        }</p>
<p>        tool_outputs = []</p>
<p>        for tool_call in run.required_action.submit_tool_outputs.tool_calls:</p>
<p>            function_name = tool_call.function.name</p>
<p>            function_to_call = available_functions[function_name]</p>
<p>            function_args = json.loads(tool_call.function.arguments)</p>
<p>            function_response = function_to_call(</p>
<p>                state_abbr=function_args.get("state_abbr"),</p>
<p>                specific_date=function_args.get("specific_date"),</p>
<p>            )</p>
<p>            print(function_response)</p>
<p>            print(tool_call.id)</p>
<p>            tool_outputs.append(</p>
<p>                { "tool_call_id": tool_call.id,</p>
<p>                 "output": str(function_response)</p>
<p>                }</p>
<p>            )</p>
<p>        run = client.beta.threads.runs.submit_tool_outputs(</p>
<p>          thread_id=thread.id,</p>
<p>          run_id=run.id,</p>
<p>          tool_outputs = tool_outputs</p>
<p>        )</p>
<p>messages = client.beta.threads.messages.list(</p>
<p>  thread_id=thread.id</p>
<p>)</p>
<p>print(messages)</p>
<p>print(messages.model_dump_json(indent=2))</p>
<p>file = client.files.create(</p>
<p>  file=open("./data/all-states-history.csv", "rb"),</p>
<p>  purpose='assistants'</p>
<p>)</p>
<p>assistant = client.beta.assistants.create(</p>
<p>  instructions="""You are an assitant answering questions about</p>
<p>                  a Covid dataset.""",</p>
<p>  model="gpt-4-1106", </p>
<p>  tools=[{"type": "code_interpreter"}],</p>
<p>  file_ids=[file.id])</p>
<p>thread = client.beta.threads.create()</p>
<p>print(thread)</p>
<p>message = client.beta.threads.messages.create(</p>
<p>    thread_id=thread.id,</p>
<p>    role="user",</p>
<p>    content="""how many hospitalized people we had in Alaska</p>
<p>               the 2021-03-05?"""</p>
<p>)</p>
<p>print(message)</p>
<p>run = client.beta.threads.runs.create(</p>
<p>  thread_id=thread.id,</p>
<p>  assistant_id=assistant.id,</p>
<p>)</p>
<p>status = run.status</p>
<p>start_time = time.time()</p>
<p>while status not in ["completed", "cancelled", "expired", "failed"]:</p>
<p>    time.sleep(5)</p>
<p>    run = client.beta.threads.runs.retrieve(</p>
<p>        thread_id=thread.id,</p>
<p>        run_id=run.id</p>
<p>    )</p>
<p>    print("Elapsed time: {} minutes {} seconds".format(</p>
<p>        int((time.time() - start_time) // 60),</p>
<p>        int((time.time() - start_time) % 60))</p>
<p>         )</p>
<p>    status = run.status</p>
<p>    print(f'Status: {status}')</p>
<p>    clear_output(wait=True)</p>
<p>messages = client.beta.threads.messages.list(</p>
<p>  thread_id=thread.id</p>
<p>)</p>
<p>print(messages.model_dump_json(indent=2))</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../posts/20240621-公雲學習筆記.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../posts/HuggingFaceLLM.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../posts/20240621-公雲學習筆記.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../posts/HuggingFaceLLM.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
